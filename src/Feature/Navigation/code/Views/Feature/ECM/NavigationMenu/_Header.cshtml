@using EMAAR.ECM.Foundation.ORM.Models.sitecore.templates.Project.ECM.Common.Content_Types
@model EMAAR.ECM.Feature.Navigation.Interface.IHeaderViewModel
@using Glass.Mapper.Sc.Web.Mvc
@using EMAAR.ECM.Foundation.SitecoreExtensions
<!-- Header starts here -->
<header class="@Model.HeaderCss">
    <div class="container">
        <div class="flexBox">
            @{ 
                //Switching the HEader component by verifying whether is home page or not
                if (Model.IsHomePage)
                {
                    if (Model != null && Model.SiteRoot != null && Model.SiteRoot.Site_Logo != null)
                    {
                        using (Html.Glass().BeginRenderLink(Model.SiteRoot, x => x.Site_Logo_Url, new { @class = "siteLogo" }, isEditable: true))
                        {
                            @Html.Glass().RenderImage(Model.SiteRoot, x => x.Site_Logo, new { alt = !String.IsNullOrEmpty(Model.SiteRoot.Site_Logo.Alt) ? Model.SiteRoot.Site_Logo.Alt : "image" }, isEditable: true)
                        }
                    }
                }
                else
                {
                    if (Model != null && Model.SiteRoot != null && Model.SiteRoot.ContentPage_SiteLogo != null)
                    {
                        using (Html.Glass().BeginRenderLink(Model.SiteRoot, x => x.Site_Logo_Url, new { @class = "siteLogo" }, isEditable: true))
                        {
                            @Html.Glass().RenderImage(Model.SiteRoot, x => x.ContentPage_SiteLogo, new { alt = !String.IsNullOrEmpty(Model.SiteRoot.ContentPage_SiteLogo.Alt) ? Model.SiteRoot.ContentPage_SiteLogo.Alt : "image" }, isEditable: true)
                        }
                    }
                }
            }
            <nav class="siteNavigation">
                <ul>
                    @{
                        if (Model != null && Model.Header.Root_Navigations != null)
                        {
                            var navigation = new List<INavigation>(Model.Header.Root_Navigations).Count;
                            if (navigation > 0)
                            {
                                foreach (var rootNav in Model.Header.Root_Navigations)
                                {
                                    int count = 0;
                                    var subNavigation = new List<ISub_Navigation>(rootNav.Sub_Navigations).Count;
                                    //If no Subnavigation (childs) then make this item as clickable
                                    if (subNavigation <= 0)
                                    {
                                        //On initial menu loading always select first item as active(example: Discovery)
                                        if (count == 0)
                                        {
                                            if (rootNav.Navigation_Link != null)
                                            {
                                                <li class="nosub">
                                                    @using (Html.Glass().BeginRenderLink(rootNav, x => x.Navigation_Link, new { @class = "active" }, isEditable: true))
                                                    {
                                                        @Html.Glass().Editable(rootNav, x => x.Navigation_Title)
                                                    }
                                                </li>
                                            }
                                        }
                                        else
                                        {

                                            if (rootNav.Navigation_Link != null)
                                            {
                                                <li class="nosub">
                                                    @using (Html.Glass().BeginRenderLink(rootNav, x => x.Navigation_Link, isEditable: true))
                                                    {
                                                        @Html.Glass().Editable(rootNav, x => x.Navigation_Title)
                                                    }
                                                </li>
                                            }
                                        }
                                        count++;
                                        continue;
                                    }
                                    <li>
                                        <!--Link with Sub navigation-->
                                        <!--Setting top level item assign class to it if it has child items -->
                                        @if (count == 0)
                                        {
                                            <a href="javascript:;" class="active"> @Html.Glass().Editable(rootNav, x => x.Navigation_Title)</a>
                                        }
                                        else
                                        {
                                            <a href="javascript:;"> @Html.Glass().Editable(rootNav, x => x.Navigation_Title)</a>

                                        }
                                        <!--Add sub menu items-->
                                        <div class="sub-menu">
                                            <ul>
                                                @if (subNavigation > 0)
                                                {
                                                    foreach (var subNav in rootNav.Sub_Navigations)
                                                    {
                                                        if (subNav.Navigation_Link != null)
                                                        {
                                                            <li>
                                                                @using (Html.Glass().BeginRenderLink(subNav, x => x.Navigation_Link, isEditable: true))
                                                                {
                                                                    @Html.Glass().Editable(subNav, x => x.Navigation_Title)
                                                                }
                                                            </li>
                                                        }
                                                    }
                                                }
                                            </ul>
                                        </div>

                                    </li>
                                    count++;
                                }
                            }
                        }
                    }
                </ul>
                <aside class="siteSearch js-sOnTrigger">
                    @{
                        var searchPage = string.Empty;
                        if (Model != null && Model.SiteRoot != null && Model.SiteRoot.Search_Page != null)
                        {
                            searchPage = Model.SiteRoot.Search_Page.Url;
                        }
                    }
                    <form action="@searchPage">
                        <div class="swrap">
                            <button class="sbtn" type="submit">
                                <img src="@Model.SearchIcon" alt="">
                            </button>
                            <div class="searchFielfds">
                                <input type="search" placeholder="@Html.Glass().Editable(Model.Header,  x => x.Search_Watermark)" class="searchinput" />
                                <a href="javascript:;" class="clsoebtn">

                                    <img src="@Model.CloseIcon" alt="">

                                </a>
                            </div>
                        </div>
                    </form>
                </aside>
                <!-- siteSearch ends here -->
            </nav>
            <!-- siteNavigation ends here -->
            <div class="mobileWrapper">
                @if (Model != null && Model.SiteRoot != null && Model.SiteRoot.Login_Page != null)
                {
                    using (Html.Glass().BeginRenderLink(Model.SiteRoot, x => x.Login_Page, new { @class = "loginmobile" }, isEditable: true))
                    {
                        <i class="ico">
                            <img src="~/Assets/Project/ECM/images/icon/login.svg" alt="login">
                        </i>
                    }
                }
                else
                {
                    <a href="javascript:;" class="loginmobile">
                        <img src="~/Assets/Project/ECM/images/icon/login.svg" alt="login">
                    </a>
                }
                <a class="hamburgers hamburger--squeeze js-hamburger mobile-menu-trigger" href="javascript:;">
                    <div class="hamburger-box">
                        <div class="hamburger-inner"></div>
                    </div>
                </a>
            </div>
        </div>
    </div>
    @if (Model != null && Model.SiteRoot != null && Model.SiteRoot.Login_Page != null)
    {
        using (Html.Glass().BeginRenderLink(Model.SiteRoot, x => x.Login_Page, new { @class = "siteLogin" }, isEditable: true))
        {
            <i class="ico">
                <img src="~/Assets/Project/ECM/images/icon/login.svg" alt="login" class="svg">
            </i>
            <span>@Html.Glass().Editable(Model.Header, x => x.Login_Text)</span>
        }
    }
    else
    {
        <a href="javascript:;" class="siteLogin">
            <i class="ico">
                <img src="~/Assets/Project/ECM/images/icon/login.svg" alt="login" class="svg">
            </i>
            <span>@Html.Glass().Editable(Model.Header, x => x.Login_Text)</span>
        </a>
    }
    <!-- siteLogin ends here -->
</header>
<!-- Header ends here -->
@{ if (!Model.IsHomePage)
    {
        <div class="headerSpace"></div>
    }
}